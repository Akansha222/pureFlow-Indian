<div class="loader" *ngIf = "loading_list">
    <div class="loding-logo">
        <mat-spinner></mat-spinner>
    </div>
</div>
<div class="main-container" *ngIf = "!loading_list" >
    <div class="offer-container">
        <div class="row">
            <div class="col s6 padding0 pr16">
                <div class="sprate-box">
                    <div class="full-offer">
                        <div class="top-heading">
                            <h2>PLUMBER DETAIL</h2>
                            <div class="review-se review-star">
                                <ul>
                                    <li [ngClass]="{'rating':getData.rating>=1}"><i class="material-icons"  >
                                        star
                                    </i></li>
                                    <li  [ngClass]="{'rating':getData.rating>=2}"><i class="material-icons">
                                        star
                                    </i></li>
                                    <li [ngClass]="{'rating':getData.rating>=3}"><i class="material-icons" >
                                        star
                                    </i></li>
                                    <li [ngClass]="{'rating':getData.rating>=4}"><i class="material-icons" >
                                        star
                                    </i></li>
                                    <li  [ngClass]="{'rating':getData.rating>=5}"><i class="material-icons">
                                        star
                                    </i></li>
                                    
                                    <p><span>{{getData.total_votes}} </span>Customer {{ getData.total_votes > 1 ?  "'s" : "" }}</p>
                                    
                                </ul>
                            </div>
                        </div>
                        
                        <div class="detail-info">
                            <div class="img-box">
                                
                                <!-- (click)="balanceModel(getData.id)" -->
                                <div class="name-box point-sec" >
                                    <div class="points ">
                                        <a  >{{total_points}}</a>
                                        <h4>Point</h4>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="basic-details">
                                <div class="profile-info">
                                    <ul>
                                        
                                        <li>
                                            <figure>
                                                <div class="left-img border">
                                                    <img [src]="getData.profile" (click)="openDialog( getData.id,'test5')" >
                                                </div>
                                                <div class="right-cont">
                                                    <p>Name</p>
                                                    <span>{{getData.first_name | titlecase }} {{getData.last_name | titlecase }}</span>
                                                </div>
                                            </figure>
                                        </li>
                                        <li>
                                            
                                            <figure>
                                                <div class="left-img">
                                                    <img src="assets/contact.svg">
                                                </div>
                                                <div class="right-cont">
                                                    <p>Mobile No.</p>
                                                    <span>{{getData.mobile_no}}</span>
                                                </div>
                                            </figure>
                                            
                                        </li>
                                        
                                        <li>
                                            <figure>
                                                <div class="left-img">
                                                    <img src="assets/calendar.svg">
                                                </div>
                                                <div class="right-cont">
                                                    <p>Date of Birth</p>
                                                    <span><ng-container *ngIf="getData.dob  != '0000-00-00' "> {{getData.dob | date: 'dd MMM yyyy'}}</ng-container></span>
                                                </div>
                                            </figure>
                                            
                                        </li>
                                        <li>
                                            <p>Status</p>
                                            <div class="center">
                                                <select class="{{getData.status}}" name="status" placeholder="Status" [(ngModel)]="getData.status" (change)="karigarsSatus() ">
                                                    <option class="Verified" value="Verified">Verified</option>
                                                    <option class="Reject" value="Reject">Reject</option>
                                                    <option class="Pending" value="Pending">Pending</option>
                                                    <option class="Suspect" value="Suspect">Suspect</option>
                                                </select> 
                                                <!-- <i class="material-icons deactive"  (click)="deleteProduct(val.id)" >delete_sweep</i>  -->
                                            </div>
                                        </li>
                                        <li>
                                            <p>Service Balance  </p>
                                            <div class="center">
                                                <select class="{{getData.service_wallet_balance_points}}" name="status" placeholder="Status" [(ngModel)]="getData.service_wallet_balance_points" (change)="redeem(getData.id) ">
                                                    <option value="Redeem">Redeem</option>
                                                    <option value="{{getData.service_wallet_balance_points}}">{{getData.service_wallet_balance_points}}</option>
                                                </select> 
                                                <!-- <i class="material-icons deactive"  (click)="deleteProduct(val.id)" >delete_sweep</i>  -->
                                            </div>
                                        </li>
                                        
                                        
                                        
                                    </ul>
                                    
                                    
                                    
                                </div>
                                
                            </div>
                            
                            
                            
                            
                        </div>
                        
                        <div class="profile-info pb20 pl14">
                            <ul>
                                <li>
                                    <figure>
                                        <div class="left-img">
                                            <img src="assets/book.svg">
                                        </div>
                                        <div class="right-cont">
                                            <p>Working Address</p>
                                            <span>{{getData.address | titlecase }}   {{getData.city | titlecase }} {{getData.district | titlecase }} {{getData.state | titlecase }} {{getData.pincode}}</span>
                                        </div>
                                    </figure>
                                </li>
                                
                                <li *ngIf="getData.permanent_address">
                                    <figure>
                                        <div class="left-img">
                                            <img src="assets/book.svg">
                                        </div>
                                        <div class="right-cont">
                                            <p>Permanent Address</p>
                                            <span>{{getData.permanent_address | titlecase }}   {{getData.permanent_city | titlecase }} {{getData.parmanent_district | titlecase }} {{getData.permanent_state | titlecase }} {{getData.permanent_pincode}}</span>
                                        </div>
                                    </figure>
                                </li>
                                
                                
                                <li *ngIf="getData.status == 'Reject' || getData.status == 'Suspect'">
                                    <figure>
                                        <div class="left-img">
                                            <img src="assets/reason.svg">
                                        </div>
                                        <div class="right-cont">
                                            <p>{{getData.status}} Reason</p>
                                            <span>{{getData.reason | titlecase }}</span>
                                            
                                        </div>
                                    </figure>
                                </li>
                                
                                <li *ngIf="getData.referral_code">
                                    <figure>
                                        <div class="left-img">
                                            <img src="assets/reason.svg">
                                        </div>
                                        <div class="right-cont">
                                            <p>Ref. Code</p>
                                            <span>{{getData.referral_code}}</span>
                                        </div>
                                    </figure>
                                </li>
                            </ul>
                        </div>
                    </div> 
                </div>
            </div>
            
            <div class="col s3 padding0 pr16">
                <div class="sprate-box">
                    <div class="full-offer">
                        <div class="top-heading">
                            <h2>DOCUMENT DETAIL</h2>
                        </div>
                        <div class="detail-info">
                            <div class="basic-details">
                                <div class="profile-info">
                                    <div class="img-box">
                                        <div class="name-box point-sec doc-file" >
                                            <img *ngIf="getData.document_image" [src]="getData.document_image" (click)="openDialog( getData.id,'test6')">
                                            
                                        </div>
                                    </div>
                                    <ul class="wp100">
                                        <li class="wp100 mr0">
                                            <div class="margin">
                                                <p>Document Type</p>
                                                <span>{{getData.document_type}}</span>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                                <div class="profile-info">
                                    <ul class="wp100">
                                        <li class="wp100 mr0 mt15">
                                            <div class="margin">
                                                <p>Document Number</p>
                                                <span>{{getData.document_no}}</span>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div> 
                </div>
            </div>
            
            <div class="col s3 padding0 ">
                
                <div class="sprate-box gift-offer">
                    <div class="full-offer">
                        <div class="top-heading">
                            <h2>Dealer DETAIL</h2>
                        </div>
                        
                        <div class="sprate-box defult">
                            <div class="detail-info defult-css">
                                
                                <div class="basic-details">
                                    <div class="profile-info">
                                        <ul class="wp100">
                                            <li class="wp100 mr0">
                                                <a><i class="material-icons"> account_circle</i></a>
                                                <div class="margin">
                                                    <p>Name</p>
                                                    <span>{{(getData.dealer_contact_person != '') ? (getData.dealer_contact_person| titlecase ): ('----')}}</span>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                    
                                    <div class="profile-info">
                                        <ul class="wp100">
                                            <li class="wp100 mr0 mt15">
                                                <a><i class="material-icons">local_phone</i></a>
                                                <div class="margin">
                                                    <p>Mobile No.</p>
                                                    <span>{{(getData.dealer_mobile != '') ? (getData.dealer_mobile) : ('----') }}</span>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                
                                
                            </div>
                        </div>
                        
                    </div>
                </div>
            </div>
        </div>
        <div class="row" >
            <div class="used-code">
                <div class="tab-header">
                    <div class="tab-header no-sticky gift-tab-list ">
                        <div class="tabs-list gift-tab-list ">
                            <ul>
                                <li (click)="mode='1'; getScannedList()" [ngClass]="{'active': mode == '1'}" >
                                    <a>
                                        <p>POINT WALLET</p>
                                        <span>{{coupon_scanned_count}}</span>
                                    </a>
                                </li>
                                <li (click)="mode='2'; getComplaintsList()" [ngClass]="{'active': mode == '2'}" >
                                    <a>
                                        <p>COMPLAINTS</p>
                                        <span>{{complaint_total}}</span>
                                    </a>
                                </li>
                            </ul>
                            
                            
                        </div>
                    </div>	
                    <div class="dobale" *ngIf="mode == '1'" >
                        <div class="top-pagination" >
                            <ul>
                                <li><p >Pages {{ current_page }} of {{ last_page }}</p></li>
                                <li><button mat-button class="left-btn" (click) = 'redirect_previous1()'><i class="material-icons">keyboard_arrow_left</i></button></li>
                                <li><input type="text" placeholder="GO TO" [(ngModel)]="current_page"  (keyup.enter)="getScannedList()"></li>
                                <li><button mat-button class="right-btn" (click) = 'redirect_next1()'><i class="material-icons">keyboard_arrow_right</i></button></li>
                            </ul>
                        </div>
                    </div>		
                    
                    <div class="dobale" *ngIf="mode == '2'" >
                        <div class="top-pagination" >
                            <ul>
                                <li><p >Pages {{ current_page }} of {{ last_page }}</p></li>
                                <li><button mat-button class="left-btn" (click) = 'redirect_previous2()'><i class="material-icons">keyboard_arrow_left</i></button></li>
                                <li><input type="text" placeholder="GO TO" [(ngModel)]="current_page"  (keyup.enter)="getComplaintsList()"></li>
                                <li><button mat-button class="right-btn" (click) = 'redirect_next2()'><i class="material-icons">keyboard_arrow_right</i></button></li>
                            </ul>
                        </div>
                    </div>	
                    
                </div>
            </div>
            
            <div class="sprate-box no-box">
                <div class="css-table " *ngIf="mode == '1'">
                    <div class="sticky-header bo-non">
                        <div class="header">
                            <table>
                                <tr>
                                    <th class="w50"></th>
                                    <th class="w200">Date Created</th>
                                    <th class="w150" >Scan Date</th>
                                    <th>Coupon Code</th>
                                    <th class="w135">Points</th>
                                </tr>
                            </table>
                        </div>
                        <div class="header">
                            <table>
                                
                                <tr>
                                    
                                    <th class="w50"></th>
                                    <th class="w200">
                                        <div class="date-form">
                                            <i *ngIf="filter.date" class="material-icons" (click)="filter.date = '';getScannedList() ">clear</i>
                                            
                                            <mat-form-field>
                                                <input matInput placeholder=" Date" [(ngModel)]="filter.date" (click)="openDatePicker(picker3)" name="date" matInput (dateChange)="getScannedList()" [matDatepicker]="picker3" readonly>
                                                <mat-datepicker-toggle matSuffix [for]="picker3"></mat-datepicker-toggle>
                                                <mat-datepicker #picker3></mat-datepicker>
                                            </mat-form-field>
                                        </div>
                                    </th>
                                    <th class="w150">
                                        <div class="date-form">
                                            <i *ngIf="filter.used_date" class="material-icons" (click)="filter.used_date = '';getScannedList() ">clear</i>
                                            
                                            <mat-form-field>
                                                <input matInput placeholder=" Search"  [(ngModel)]="filter.used_date" (click)="openDatePicker(picker5)" name="used_date" matInput (dateChange)="getScannedList()" [matDatepicker]="picker5" readonly>
                                                <mat-datepicker-toggle matSuffix [for]="picker5"></mat-datepicker-toggle>
                                                <mat-datepicker #picker5></mat-datepicker>
                                            </mat-form-field>
                                        </div>
                                    </th>
                                    <th>
                                        <div class="search-form">
                                            <input type="text" placeholder="Search" [(ngModel)]="filter.coupon_code"  (keyup.enter)="current_page = 1;getScannedList()">
                                            <i class="material-icons">search</i>
                                        </div>
                                    </th>
                                    
                                    <th class="w135">
                                        <div class="search-form">
                                            <input type="text" placeholder="Search" [(ngModel)]="filter.points"  (keyup.enter)="current_page = 1;getScannedList()">
                                            <i class="material-icons">search</i>
                                        </div>
                                        
                                        
                                    </th>
                                </tr>
                            </table>
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <div class="table-body">
                            <table>
                                <tr *ngIf="getData.point_remark!=''">
                                    <td class="w50"></td>
                                    <td class="w200"></td>
                                    <td class="w150"></td>
                                    <td>{{getData.point_remark}}</td>
                                    <td class="w135">{{getData.reg_points}}</td>
                                </tr>
                                <tr *ngIf="getData.referal_point_balance!=''">
                                    <td class="w50"></td>
                                    <td class="w200"></td>
                                    <td class="w150"></td>
                                    <td>Referral Points</td>
                                    <td class="w135">{{getData.referal_point_balance}}</td>
                                </tr>
                                <tr *ngFor="let val of scanned_coupon; let i = index">
                                    <td class="w50">{{ i + 1 }}</td>
                                    <td class="w200" ><ng-container *ngIf="val.date_created  != '0000-00-00 00:00:00' "> {{val.date_created | date: 'dd MMM yyyy'}} </ng-container></td>
                                    <td class="w150">{{val.scan_date | date : 'dd MMM yyyy'}} </td>
                                    <td>{{val.coupon_code}} </td>
                                    <td class=" w135">{{val.coupon_value}}</td>
                                </tr>
                                
                                
                            </table>
                        </div>
                    </div>
                </div>
                
                <div class="css-table" *ngIf="mode == '2'">
                    <div class="sticky-header">
                        <div class="header">
                            <table>
                                <tr>
                                    <th class="w100">CMP No.</th>
                                    <th class="w150">Date / Created By </th>
                                    <th class="w200">Customer Name</th>
                                    <th class="w130">Mobile</th>
                                    <th>Address</th>
                                    <th class="w100">Days</th>
                                    <th>Nature Problem</th>
                                    <th class="w100">OTP</th>
                                    <th class="w100">Status</th>
                                </tr>
                                
                            </table>
                        </div>
                        
                        <div class="header border-bott">
                            <table>
                                <tr>
                                    <th class="w100"></th>
                                    <th class="w150">
                                        <div class="date-form">
                                            <i *ngIf="filter.date" class="material-icons" (click)="filter.date = '';getComplaintsList() ">clear</i>
                                            
                                            <mat-form-field >
                                                <input placeholder="Search" [(ngModel)]="filter.date"  name="date" (click)="openDatePicker(picker)" matInput (dateChange)="getComplaintsList()" [matDatepicker]="picker" readonly>
                                                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                                <mat-datepicker #picker></mat-datepicker>
                                            </mat-form-field>
                                            
                                        </div>
                                    </th>
                                    
                                    <th class="w200">
                                        <div class="search-form">
                                            <input type="text" placeholder="Search" [(ngModel)]="filter.customer_name"  (keyup.enter)="current_page = 1;getComplaintsList()">
                                            <i class="material-icons">search</i>
                                        </div>
                                    </th>
                                    
                                    <th class="w130">
                                        <div class="search-form">
                                            <input type="text" placeholder="Search" [(ngModel)]="filter.mobile"  (keyup.enter)="current_page = 1;getComplaintsList()">
                                            <i class="material-icons">search</i>
                                        </div>
                                    </th>
                                    
                                    <th>
                                        <div class="search-form">
                                            <input type="text" placeholder="Search" [(ngModel)]="filter.address"  (keyup.enter)="current_page = 1;getComplaintsList()">
                                            <i class="material-icons">search</i>
                                        </div>
                                    </th>
                                    <th class="w100">
                                        <div class="search-form">
                                            <input type="text" placeholder="Search" [(ngModel)]="filter.days"  (keyup.enter)="current_page = 1;getComplaintsList()">
                                            <i class="material-icons">search</i>
                                        </div>
                                    </th>
                                    <th>
                                        <div class="search-form">
                                            <input type="text" placeholder="Search" [(ngModel)]="filter.nature_problem"  (keyup.enter)="current_page = 1;getComplaintsList()">
                                            <i class="material-icons">search</i>
                                        </div>
                                    </th>
                                    <th class="w100">
                                        <div class="search-form">
                                            <input type="text" placeholder="Search" [(ngModel)]="filter.otp"  (keyup.enter)="current_page = 1;getComplaintsList()">
                                            <i class="material-icons">search</i>
                                        </div>
                                    </th>
                                    <th class="w100">
                                    </th>
                                </tr>
                            </table>
                        </div>
                    </div>
                    
                    <div class="table-container" *ngIf="complaint.length">
                        <div class="table-body">
                            <table> 
                                <tr *ngFor="let val of complaint; let i = index">
                                    <td class="w100"><a class="blue" routerLink="/complaints-detail/{{val.id}}" routerLinkActive="active">Com#{{val.id}}</a></td>
                                    <td class="w150"><ng-container *ngIf="val.date_created  != '0000-00-00 00:00:00' "> {{val.date_created | date: 'dd MMM yyyy'}} / {{val.created_name}} </ng-container> </td>
                                    <td class="w200"><a class="blue" routerLink="/customer-detail/{{val.customer_id}}" routerLinkActive="active">{{val.customer_name | titlecase }}</a></td>
                                    <td class="w130">{{val.mobile_no}}</td>
                                    <td>{{val.address | titlecase }} {{val.city | titlecase }} {{val.district | titlecase }} {{val.state | titlecase }} {{val.pincode }}</td>
                                    <td class="w100">{{ toInt(val.days_count ) + 1}} Days</td>
                                    <td>{{val.nature_problem}}</td>
                                    <td class="w100">{{val.otp}}</td>
                                    <td class="w100 {{val.status}} ">
                                        
                                        <a *ngIf="val.status == 'Pending'" (click)="changeStatus(i, val.id, val.status )" >{{val.status}}</a>
                                        <a *ngIf="val.status ==  'Cancel' || val.status == 'Closed' " >{{val.status}}</a>
                                        
                                        <div class="over-sec lar-h12" *ngIf="val.status == 'Pending'">
                                            <i class="material-icons" routerLink="/complaints-add/{{val.id}}" routerLinkActive="active">edit</i>
                                        </div> 
                                        
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    
                </div>
                
            </div>
            
            <div class="date-not" *ngIf="mode == '1' && !loading_list && !scanned_coupon.length && coupon_scanned_count">
                <div class="no-img">
                    <img src="assets/result-not-found.png"> 
                </div>
            </div>
            
            <div class="date-not"  *ngIf="mode == '1' && !loading_list && !coupon_scanned_count ">
                <div class="no-img">
                    <img src="assets/not-available.jpg"> 
                </div>
                
            </div>	
            
            
            <div class="date-not" *ngIf="mode == '2' && !loading_list && !complaint.length && complaint_total">
                <div class="no-img">
                    <img src="assets/result-not-found.png"> 
                </div>
            </div>
            
            <div class="date-not"  *ngIf="mode == '2' && !loading_list && !complaint_total ">
                <div class="no-img">
                    <img src="assets/not-available.jpg"> 
                </div>
                
            </div>	
            
            
        </div>
    </div>
</div>

<div class="add-button">
    <button mat-button (click)="edit()"><i class="material-icons">edit</i></button>
</div>